
QUESTPDF_CDEF += r"""
    {% for typedef in CallbackTypedefs %}
    {{ typedef }}
    {% endfor %}

    {% for header in Headers %}
    {{ header }}
    {% endfor %}

{{ customInit }}
"""

{{ customDefinitions }}

class {{ className }}{% if inheritFrom %}({{ inheritFrom }}){% endif %}:
    def __init__(self, target_pointer):
        self.target_pointer = target_pointer
        self._callbacks = []  # prevent GC of callbacks during native calls

{% for method in methods %}
    {% if method.deprecationMessage %}@deprecated("{{ method.deprecationMessage }}"){% endif %}
    {% if method.isStaticMethod %}@staticmethod{% endif %}
    def {{ method.methodName }}({{ method.parameters }}) -> {% if method.returnConversionMethod %}'{{ method.returnType }}'{% else %}None{% endif %}:
{% for callback in method.callbacks %}
        @questpdf_ffi.callback("void(void*)")
        def {{ callback.internalCallbackName }}({{ callback.parameterName }}_pointer):
            {{ callback.parameterName }}_object = {{ callback.argumentTypeName }}({{ callback.parameterName }}_pointer)
            {{ callback.parameterName }}({{ callback.parameterName }}_object)

        self._callbacks.append({{ callback.internalCallbackName }})
{% endfor %}

        result = questpdf.lib.{{ method.nativeMethodName }}({{ method.nativeCallArgs }})
        {% if method.returnConversionMethod %}return {{ method.returnConversionMethod }}(result){% endif %}
{% endfor %}

{{ customClass }}
